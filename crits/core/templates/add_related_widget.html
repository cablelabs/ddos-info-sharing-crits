{% load filters %}
<div class="content_box" id="add_related_box">
    <div id="add_related" hidden></div>
    <h3 class='titleheader'>
        <span>Add Related</span>
    </h3>
    <div data-intro"Section for adding related Objects." data-position="bottom">
        <form id="add_related_form" method="post"> {% csrf_token %}
            <select id="add_related_options" onchange="populateList()">
                <option>Choose TLO</option>
                {% if acl.ACTOR_WRITE|has_access_to:user %}
                  <option value='new-actor'>Actor</option>
                {% endif %}
                {% if acl.BACKDOOR_WRITE|has_access_to:user %}
                  <option value='new-backdoor'>Backdoor</option>
                {% endif %}
                {% if acl.CAMPAIGN_WRITE|has_access_to:user %}
                  <option value='new-campaign'>Campaign</option>
                {% endif %}
                {% if acl.CERTIFICATE_WRITE|has_access_to:user %}
                  <option value='new-certificate'>Certificate</option>
                {% endif %}
                {% if acl.DOMAIN_WRITE|has_access_to:user %}
                  <option value='new-domain'>Domain</option>
                {% endif %}
                {% if acl.EMAIL_WRITE|has_access_to:user %}
                  <option value='new-email-fields'>Email</option>
                  <option value='new-email-eml'>Email (eml)</option>
                  <option value='new-email-raw'>Email (raw)</option>
                  <option value='new-email-yaml'>Email (YAML)</option>
                  <option value='new-email-outlook'>Email (Outlook)</option>
                {% endif %}
                {% if acl.EVENT_WRITE|has_access_to:user %}
                  <option value='new-event'>Event</option>
                {% endif %}
                {% if acl.EXPLOIT_WRITE|has_access_to:user %}
                  <option value='new-exploit'>Exploit</option>
                {% endif %}
                {% if acl.INDICATOR_WRITE|has_access_to:user %}
                  <option value='new-indicator'>Indicator</option>
                  <option value='new-indicator-csv'>Indicator (csv)</option>
                  <option value='indicator-blob'>Indicator (blob)</option>
                {% endif %}
                {% if acl.IP_WRITE|has_access_to:user %}
                  <option value='new-ip'>IP</option>
                {% endif %}
                {% if acl.PCAP_WRITE|has_access_to:user %}
                  <option value='new-pcap'>PCAP</option>
                {% endif %}
                {% if acl.RAWDATA_WRITE|has_access_to:user %}
                  <option value='new-raw-data'>Raw Data</option>
                  <option value='new-raw-data-file'>Raw Data File</option>
                {% endif %}
                {% if acl.SAMPLE_WRITE|has_access_to:user %}
                  <option value='new-sample'>Sample</option>
                {% endif %}
                {% if acl.SIGNATURE_WRITE|has_access_to:user %}
                  <option value='new-signature'>Signature</option>
                {% endif %}
                {% if acl.TARGET_WRITE|has_access_to:user %}
                  <option value='new-target'>Target</option>
                {% endif %}
            </select>
        </form>
    </div>
</div>


<script type="text/javascript">
    function populateList() {
        var selected_option = document.getElementById('add_related_options');
        var add_related_div = document.getElementById('add_related');
        add_related_div.setAttribute("dialog", selected_option.value);
        add_related_div.setAttribute("persona", "related");
        add_related_div.setAttribute("class", "dialogClick");
        add_related_div.click();

    }
</script>
